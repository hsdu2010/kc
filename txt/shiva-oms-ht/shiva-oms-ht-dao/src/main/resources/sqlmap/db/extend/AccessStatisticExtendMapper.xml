<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sf.shiva.oms.ht.mapper.extend.AccessStatisticExtendMapper">
  <resultMap id="BaseResultMap" type="com.sf.shiva.oms.ht.domain.AccessStatistic">
    <id column="statistic_date" jdbcType="DATE" property="statisticDate" />
    <id column="module_name" jdbcType="VARCHAR" property="moduleName" />
    <result column="user_num" jdbcType="INTEGER" property="userNum" />
    <result column="usage_count" jdbcType="INTEGER" property="usageCount" />
  </resultMap>
  
  <select id="findModuleAccessStatistics" parameterType="java.util.Date" resultMap="BaseResultMap">
  	SELECT COUNT(DISTINCT ip) user_num, COUNT(ip) usage_count, module_name, #{startTime} statistic_date
  	FROM tt_operation_info
  	WHERE operate_time <![CDATA[>=]]> #{startTime} AND operate_time <![CDATA[<=]]> #{endTime}
  	GROUP BY module_name 
  </select>
  
  <select id="findTotalAccessStatistic" parameterType="java.util.Date" resultMap="BaseResultMap">
  	SELECT COUNT(DISTINCT ip) user_num, COUNT(ip) usage_count, 'shiva-oms-ht' module_name, #{startTime} statistic_date
  	FROM tt_operation_info
  	WHERE operate_time <![CDATA[>=]]> #{startTime} AND operate_time <![CDATA[<=]]> #{endTime}
  </select>
  
</mapper>